<html>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>

<div id="my_dataviz"></div>

<style>
    /* Add your CSS styles here! */
</style>

<body>
    <script>
        var margin = {
                top: 200,
                right: 25,
                bottom: 30,
                left: 200
            },
            width = 450 - margin.left - margin.right,
            height = 450 - margin.top - margin.bottom;
        //
        var tooltip = d3.select("#my_dataviz")
            .append("div")
            .style("opacity", 0)
            .attr("class", "tooltip")
            .style("background-color", "white")
            .style("border", "solid")
            .style("border-width", "2px")
            .style("border-radius", "5px")
            .style("padding", "5px")
        //



        // Three function that change the tooltip when user hover / move / leave a cell
        var mouseover = function(d) {
            tooltip
                .style("opacity", 1)
            d3.select(this)
                .style("stroke", "black")
                .style("opacity", 1)
        }
        var mousemove = function(d) {
            tooltip
                .html("The activation value of<br>this cell is: " + d.PetalWidthCm)
                .style("left", (d3.mouse(this)[0] + 70) + "px")
                .style("top", (d3.mouse(this)[1]) + "px")
        }
        var mouseleave = function(d) {
            tooltip
                .style("opacity", 0)
            d3.select(this)
                .style("stroke", "none")
                .style("opacity", 0.8)
        }


        //function, loop through each element
        function hb() {
            cell = data
            data.forEach(function(d, i) {
                let pair = data[i]; // 1word

                d3.json("acitvations_LSTM.json", function(data) {
                    let cell = data[i]; // work with just one cell for now

                    console.log(cell["headline"]);

                    let headlines = cell["headline"];
                    let body1 = cell["body"];


                    var myColor = d3.scaleSequential()
                        .interpolator(d3.interpolateRdBu)
                        .domain([-1, 1])

                    headlines.forEach(function(d, i) {
                        let key = Object.keys(d)[i]; // 1word
                        let value = Number(Object.values(d)[i]); //1value



                        console.log(key, value);

                        d[key] = value;
                    });

                    body1.forEach(function(d, i) {
                        let key2 = Object.keys(d)[i]; // 1word
                        let value2 = Number(Object.values(d)[i]); //1value



                        console.log(key2, value2);

                        d[key2] = value2;
                    });



                    console.log(headlines);

                    let headline_container = d3.select("body").append("div")
                        .attr("class", "headline")
                        .style("margin-bottom", "10px")
                        .style("margin-top", "10px")
                        .style("margin-left", "50px")
                        .style("margin-right", "50px");

                    let body_container = d3.select("body").append("div")
                        .attr("class", "body")
                        .style("margin-bottom", "10px")
                        .style("margin-top", "10px")
                        .style("margin-left", "50px")
                        .style("margin-right", "50px");




                    headlines.forEach(function(d, i) {
                        var key = Object.keys(d)[i];
                        var value = Number(Object.values(d)[i]);



                        // Append the word for element d onto headline_container
                        headline_container.append("span")
                            .attr("T", i) // The index of the current word in the headline
                            .text(key)
                            .style("background-color", myColor(value * 10));
                        // .on("mouseover", mouseover)
                        // .on("mousemove", mousemove)
                        // .on("mouseleave", mouseleave)

                        // Add a space between each word
                        headline_container.append("span").text(" ");
                    })


                    body1.forEach(function(d, i) {
                        var key2 = Object.keys(d)[i];
                        var value2 = Number(Object.values(d)[i]);



                        // Append the word for element d onto headline_container
                        body_container.append("span")
                            .attr("T", i) // The index of the current word in the headline
                            .text(key2)
                            .style("background-color", myColor(value2 * 10));


                        // .on("mouseover", mouseover)
                        // .on("mousemove", mousemove)
                        // .on("mouseleave", mouseleave)

                        // Add a space between each word
                        body_container.append("span").text(" ");
                    })
                })
            });
            //    });
        }
    </script>
</body>

</html>